DAG construction and Simple code generation
